{
   "data" : {
      "y" : {
         "data" : [
            [
               4,
               4,
               4,
               3,
               5,
               6,
               6,
               5,
               5,
               3,
               4,
               5,
               6,
               5,
               7,
               6,
               3,
               5,
               4,
               4,
               6,
               7,
               4,
               7,
               7,
               4,
               9,
               3,
               3,
               6,
               6,
               9,
               7,
               8
            ],
            [
               3,
               4,
               3,
               2,
               3,
               5,
               5,
               4,
               4,
               3,
               2,
               2,
               3,
               4,
               6,
               4,
               2,
               5,
               3,
               2,
               5,
               6,
               3,
               4,
               7,
               7,
               7,
               4,
               5,
               5,
               6,
               5,
               9,
               6
            ],
            [
               3,
               3,
               1,
               1,
               2,
               4,
               4,
               1,
               1,
               2,
               2,
               1,
               2,
               1,
               3,
               2,
               1,
               4,
               1,
               1,
               3,
               4,
               2,
               3,
               4,
               1,
               3,
               1,
               1,
               2,
               3,
               2,
               4,
               1
            ],
            [
               14,
               13,
               17,
               11,
               16,
               17,
               17,
               13,
               14,
               14,
               16,
               15,
               12,
               13,
               17,
               16,
               16,
               13,
               12,
               12,
               17,
               19,
               15,
               16,
               15,
               16,
               13,
               16,
               13,
               15,
               15,
               16,
               16,
               17
            ],
            [
               13,
               14,
               12,
               11,
               15,
               18,
               16,
               15,
               14,
               15,
               16,
               13,
               11,
               14,
               11,
               15,
               17,
               11,
               11,
               11,
               16,
               19,
               15,
               14,
               11,
               12,
               12,
               13,
               13,
               12,
               13,
               14,
               16,
               17
            ],
            [
               15,
               17,
               16,
               12,
               14,
               18,
               19,
               15,
               15,
               13,
               11,
               16,
               14,
               15,
               18,
               18,
               15,
               18,
               14,
               11,
               19,
               19,
               15,
               18,
               19,
               18,
               17,
               17,
               16,
               18,
               18,
               17,
               19,
               17
            ]
         ],
         "vars" : [
            "wl1",
            "wl2",
            "wl3",
            "se1",
            "se2",
            "se3"
         ],
         "smps" : [
            "Smp1",
            "Smp2",
            "Smp3",
            "Smp4",
            "Smp5",
            "Smp6",
            "Smp7",
            "Smp8",
            "Smp9",
            "Smp10",
            "Smp11",
            "Smp12",
            "Smp13",
            "Smp14",
            "Smp15",
            "Smp16",
            "Smp17",
            "Smp18",
            "Smp19",
            "Smp20",
            "Smp21",
            "Smp22",
            "Smp23",
            "Smp24",
            "Smp25",
            "Smp26",
            "Smp27",
            "Smp28",
            "Smp29",
            "Smp30",
            "Smp31",
            "Smp32",
            "Smp33",
            "Smp34"
         ]
      },
      "x" : {
         "group" : [
            "Control",
            "Control",
            "Control",
            "Control",
            "Control",
            "Control",
            "Control",
            "Control",
            "Control",
            "Control",
            "Control",
            "Control",
            "Diet",
            "Diet",
            "Diet",
            "Diet",
            "Diet",
            "Diet",
            "Diet",
            "Diet",
            "Diet",
            "Diet",
            "Diet",
            "Diet",
            "DietEx",
            "DietEx",
            "DietEx",
            "DietEx",
            "DietEx",
            "DietEx",
            "DietEx",
            "DietEx",
            "DietEx",
            "DietEx"
         ]
      }
   },
   "info" : "<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, user-scalable=yes\" />\n<script type=\"text/javascript\">\nconst macros = { \"\\\\R\": \"\\\\textsf{R}\", \"\\\\code\": \"\\\\texttt\"};\nfunction processMathHTML() {\n    var l = document.getElementsByClassName('reqn');\n    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }\n    return;\n}</script>\n<script defer src=\"https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js\"\n    onload=\"processMathHTML();\"></script>\n<table style=\"width: 100%;\"><tr><td>WeightLoss</td><td style=\"text-align: right;\">R Documentation</td></tr></table>\n<h2>Weight Loss Data</h2>\n<h3>Description</h3>\n<p>Contrived data on weight loss and self esteem over three months, for three\ngroups of individuals: Control, Diet and Diet + Exercise. The data\nconstitute a double-multivariate design.\n</p>\n<h3>Format</h3>\n<p>A data frame with 34 observations on the following 7 variables.\n</p>\n<dl>\n<dt><code>group</code></dt><dd><p>a factor with levels <code>Control</code>\n<code>Diet</code> <code>DietEx</code>.</p>\n</dd> <dt><code>wl1</code></dt><dd><p>Weight loss at 1 month</p>\n</dd>\n<dt><code>wl2</code></dt><dd><p>Weight loss at 2 months</p>\n</dd> \n<dt><code>wl3</code></dt><dd><p>Weight loss at 3 months</p>\n</dd> \n<dt><code>se1</code></dt><dd><p>Self esteem at 1 month</p>\n</dd>\n<dt><code>se2</code></dt><dd><p>Self esteem at 2 months</p>\n</dd> \n<dt><code>se3</code></dt><dd><p>Self esteem at 3 months</p>\n</dd> \n</dl>\n<h3>Details</h3>\n<p>Helmert contrasts are assigned to <code>group</code>, comparing <code>Control</code> vs.\n(<code>Diet</code> <code>DietEx</code>) and <code>Diet</code> vs. <code>DietEx</code>.\n</p>\n<h3>Source</h3>\n<p>Originally taken from\n<a href=\"http://www.csun.edu/~ata20315/psy524/main.htm\">http://www.csun.edu/~ata20315/psy524/main.htm</a>, but modified slightly\n</p>\n<h3>References</h3>\n<p>Friendly, Michael (2010). HE Plots for Repeated Measures\nDesigns. <em>Journal of Statistical Software</em>, 37(4), 1-40.\n<a href=\"https://doi.org/10.18637/jss.v037.i04\">doi:10.18637/jss.v037.i04</a>.\n</p>\n<h3>Examples</h3>\n<pre><code class='language-R'>\ndata(WeightLoss)\nstr(WeightLoss)\ntable(WeightLoss$group)\ncontrasts(WeightLoss$group) &lt;- matrix(c(-2,1,1, 0, -1, 1),ncol=2)\n(wl.mod&lt;-lm(cbind(wl1,wl2,wl3,se1,se2,se3)~group, data=WeightLoss))\nheplot(wl.mod, hypotheses=c(\"group1\", \"group2\"))\npairs(wl.mod, variables=1:3)\npairs(wl.mod, variables=4:6)\n# within-S variables\nwithin &lt;- data.frame(measure=rep(c(\"Weight loss\", \"Self esteem\"),each=3), month=rep(ordered(1:3),2))\n# doubly-multivariate analysis: requires car 2.0+\n## Not run: \nimatrix &lt;- matrix(c(\n\t1,0,-1, 1, 0, 0,\n\t1,0, 0,-2, 0, 0,\n\t1,0, 1, 1, 0, 0,\n\t0,1, 0, 0,-1, 1,\n\t0,1, 0, 0, 0,-2,\n\t0,1, 0, 0, 1, 1), 6, 6, byrow=TRUE)\n# NB: for heplots the columns of imatrix should have names\ncolnames(imatrix) &lt;- c(\"WL\", \"SE\", \"WL.L\", \"WL.Q\", \"SE.L\", \"SE.Q\")\nrownames(imatrix) &lt;- colnames(WeightLoss)[-1]\n(imatrix &lt;- list(measure=imatrix[,1:2], month=imatrix[,3:6]))\ncontrasts(WeightLoss$group) &lt;- matrix(c(-2,1,1, \n                                        0,-1,1), ncol=2) \n(wl.mod&lt;-lm(cbind(wl1, wl2, wl3, se1, se2, se3)~group, data=WeightLoss))\n(wl.aov &lt;- car::Anova(wl.mod, imatrix=imatrix, test=\"Roy\"))\nheplot(wl.mod, imatrix=imatrix, iterm=\"group:measure\")\n## End(Not run)\n# do the correct analysis 'manually'\nunit &lt;- function(n, prefix=\"\") {\n\tJ &lt;-matrix(rep(1, n), ncol=1)\n\trownames(J) &lt;- paste(prefix, 1:n, sep=\"\")\n\tJ\nmeasure &lt;- kronecker(diag(2), unit(3, 'M')/3, make.dimnames=TRUE)\ncolnames(measure)&lt;- c('WL', 'SE')\nbetween &lt;- as.matrix(WeightLoss[,-1]) %*% measure\nbetween.mod &lt;- lm(between ~ group, data=WeightLoss)\ncar::Anova(between.mod)\nheplot(between.mod, hypotheses=c(\"group1\", \"group2\"), \n\txlab=\"Weight Loss\", ylab=\"Self Esteem\",\n\tcol=c(\"red\", \"blue\", \"brown\"),\n\tmain=\"Weight Loss &amp; Self Esteem: Group Effect\")\nmonth &lt;- kronecker(diag(2), poly(1:3), make.dimnames=TRUE)\ncolnames(month)&lt;- c('WL', 'SE')\ntrends &lt;- as.matrix(WeightLoss[,-1]) %*% month\nwithin.mod &lt;- lm(trends ~ group, data=WeightLoss)\ncar::Anova(within.mod)\nheplot(within.mod)\nheplot(within.mod, hypotheses=c(\"group1\", \"group2\"), \n\txlab=\"Weight Loss\", ylab=\"Self Esteem\",\n\ttype=\"III\", remove.intercept=FALSE,\n\tterm.labels=c(\"month\", \"group:month\"),\n\tmain=\"Weight Loss &amp; Self Esteem: Within-S Effects\")\nmark.H0()\n</code></pre>\n</main>\n</div>\n",
   "config" : {
      "subtitle" : "heplots - WeightLoss",
      "smpOverlays" : [
         "group"
      ],
      "graphType" : "Heatmap",
      "title" : "Weight Loss Data"
   }
}
